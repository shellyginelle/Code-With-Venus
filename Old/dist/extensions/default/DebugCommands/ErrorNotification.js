define(function(require,exports,module){"use strict";var _=brackets.getModule("thirdparty/lodash"),AnimationUtils=brackets.getModule("utils/AnimationUtils"),ExtensionUtils=brackets.getModule("utils/ExtensionUtils"),Strings=brackets.getModule("strings");var $span=null,errorCount=0,_attached=false,_windowOnError,_consoleError,_consoleClear;ExtensionUtils.loadStyleSheet(module,"styles.css");function showDeveloperTools(){try{brackets.app.showDeveloperTools()}catch(err){console.error(err)}}function handleClick(event){if(event.shiftKey){window.console.clear()}else{showDeveloperTools()}}function refreshIndicator(){if(!_attached||errorCount===0){if($span){$span.parent().hide()}return}if($span){$span.text(errorCount).parent().show();return}$span=$("<span>").text(errorCount);$("<div>").attr("id","error-counter").attr("title",Strings.CMD_SHOW_DEV_TOOLS+"â€¦").text(Strings.ERRORS+": ").append($span).on("click",handleClick).insertBefore("#status-bar .spinner")}var blink=_.debounce(function(){AnimationUtils.animateUsingClass($span.parent()[0],"flash",1500)},100);function incErrorCount(){errorCount++;blink();refreshIndicator()}function clearErrorCount(){errorCount=0;refreshIndicator()}function attachFunctions(){if(_attached){return}_attached=true;_windowOnError=window.onerror;_consoleError=window.console.error;_consoleClear=window.console.clear;window.onerror=function(errorMsg,url,lineNumber){incErrorCount();if(_windowOnError){return _windowOnError(errorMsg,url,lineNumber)}return false};window.console.error=function(){incErrorCount();return _consoleError.apply(window.console,arguments)};window.console.clear=function(){clearErrorCount();return _consoleClear.apply(window.console,arguments)}}function detachFunctions(){if(!_attached){return}_attached=false;window.onerror=_windowOnError;window.console.error=_consoleError;window.console.clear=_consoleClear}function toggle(bool){if(bool){attachFunctions()}else{detachFunctions()}refreshIndicator()}exports.toggle=toggle});