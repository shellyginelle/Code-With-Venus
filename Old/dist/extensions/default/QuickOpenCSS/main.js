define(function(require,exports,module){"use strict";var EditorManager=brackets.getModule("editor/EditorManager"),QuickOpen=brackets.getModule("search/QuickOpen"),CSSUtils=brackets.getModule("language/CSSUtils"),DocumentManager=brackets.getModule("document/DocumentManager"),StringMatch=brackets.getModule("utils/StringMatch");function createSelectorList(){var doc=DocumentManager.getCurrentDocument();if(!doc){return}var docText=doc.getText();return CSSUtils.extractAllSelectors(docText,doc.getLanguage().getMode())}function search(query,matcher){var selectorList=matcher.selectorList;if(!selectorList){selectorList=createSelectorList();matcher.selectorList=selectorList}query=query.slice(query.indexOf("@")+1,query.length);var filteredList=$.map(selectorList,function(itemInfo){var searchResult=matcher.match(CSSUtils.getCompleteSelectors(itemInfo),query);if(searchResult){searchResult.selectorInfo=itemInfo}return searchResult});StringMatch.basicMatchSort(filteredList);return filteredList}function match(query){return query[0]==="@"}function itemFocus(selectedItem,query,explicit){if(!selectedItem||query.length<2&&!explicit){return}var selectorInfo=selectedItem.selectorInfo;var from={line:selectorInfo.selectorStartLine,ch:selectorInfo.selectorStartChar};var to={line:selectorInfo.selectorStartLine,ch:selectorInfo.selectorEndChar};EditorManager.getCurrentFullEditor().setSelection(from,to,true)}function itemSelect(selectedItem,query){itemFocus(selectedItem,query,true)}QuickOpen.addQuickOpenPlugin({name:"CSS Selectors",languageIds:["css","less","scss"],search:search,match:match,itemFocus:itemFocus,itemSelect:itemSelect})});