define(function(require,exports,module){"use strict";var SpecRunnerUtils=brackets.getModule("spec/SpecRunnerUtils"),FileUtils=brackets.getModule("file/FileUtils");describe("JSLint",function(){var testFolder=FileUtils.getNativeModuleDirectoryPath(module)+"/unittest-files/",testWindow,$,brackets,CodeInspection,EditorManager;var toggleJSLintResults=function(visible){$("#status-inspection").triggerHandler("click");expect($("#problems-panel").is(":visible")).toBe(visible)};beforeEach(function(){runs(function(){SpecRunnerUtils.createTestWindowAndRun(this,function(w){testWindow=w;$=testWindow.$;brackets=testWindow.brackets;EditorManager=testWindow.brackets.test.EditorManager;CodeInspection=testWindow.brackets.test.CodeInspection;CodeInspection.toggleEnabled(true)})});runs(function(){SpecRunnerUtils.loadProjectInTestWindow(testFolder)})});afterEach(function(){testWindow=null;$=null;brackets=null;EditorManager=null;SpecRunnerUtils.closeTestWindow()});it("should run JSLint linter when a JavaScript document opens",function(){runs(function(){spyOn(testWindow,"JSLINT").andCallThrough()});waitsForDone(SpecRunnerUtils.openProjectFiles(["errors.js"]),"open test file");runs(function(){expect(testWindow.JSLINT).toHaveBeenCalled()})});it("status icon should toggle Errors panel when errors present",function(){waitsForDone(SpecRunnerUtils.openProjectFiles(["errors.js"]),"open test file");runs(function(){toggleJSLintResults(false);toggleJSLintResults(true)})});it("status icon should not toggle Errors panel when no errors present",function(){waitsForDone(SpecRunnerUtils.openProjectFiles(["no-errors.js"]),"open test file");runs(function(){toggleJSLintResults(false);toggleJSLintResults(false)})});it("should default to the editor's indent",function(){waitsForDone(SpecRunnerUtils.openProjectFiles(["different-indent.js"]),"open test file");runs(function(){toggleJSLintResults(false);toggleJSLintResults(false)})})})});