define(function(require,exports,module){"use strict";var EditorManager=brackets.getModule("editor/EditorManager"),ExtensionUtils=brackets.getModule("utils/ExtensionUtils"),lineWidgetHTML=require("text!inlineWidget.html"),currentErrorWidget,errorToggle,isShowingDescription;ExtensionUtils.loadStyleSheet(module,"main.less");require("tooltipsy.source");function cleanUp(line){removeButton();removeHighlight(line);hideDescription();isShowingDescription=false}function scafoldHinter(errorStart,errorEnd,errorObj){errorToggle=document.createElement("div");isShowingDescription=false;showButton(errorObj);highlight(errorObj);errorToggle.onclick=function(){if(!isShowingDescription){showDescription(errorObj)}else{hideDescription()}isShowingDescription=!isShowingDescription};return $(errorToggle)}function getActiveEditor(){return EditorManager.getActiveEditor()}function getCodeMirror(){return getActiveEditor()._codeMirror}function highlight(errorObject){if(!errorObject.line){return}getCodeMirror().getDoc().addLineClass(errorObject.line,"background","errorHighlight")}function removeHighlight(line){if(!line){return}getCodeMirror().getDoc().removeLineClass(line,"background","errorHighlight")}function showButton(errorObject){getCodeMirror().addWidget(errorObject,errorToggle,false);$(errorToggle).attr("class","hint-marker-positioning hint-marker-error").removeClass("hidden");$(".hint-marker-positioning").tooltipsy({content:"Click error icon for details",alignTo:"cursor",offset:[10,-10]})}function removeButton(){if(!errorToggle){return}if(errorToggle.parentNode){$(errorToggle).remove()}var tooltips=$(".hint-marker-positioning").data("tooltipsy");if(tooltips){tooltips.destroy()}isShowingDescription=false}function showDescription(error){var description=document.createElement("div");description.className="errorPanel";description.innerHTML=Mustache.render(lineWidgetHTML,{error:error.message});var options={coverGutter:false,noHScroll:false,above:false,showIfHidden:false};currentErrorWidget=getCodeMirror().addLineWidget(error.line,description,options)}function hideDescription(){if(!currentErrorWidget){return}currentErrorWidget.clear();currentErrorWidget=null}exports.cleanUp=cleanUp;exports.scafoldHinter=scafoldHinter});